{
  "name": "3D HD Soft - DDD & API Course Environment",
  "dockerComposeFile": "docker-compose.yml",
  "service": "dev",
  "workspaceFolder": "/workspace",

  "features": {
    "ghcr.io/devcontainers/features/git:1": {},
    "ghcr.io/devcontainers/features/github-cli:1": {},
    "ghcr.io/oven-sh/devcontainers/features/bun:1": {},
    "ghcr.io/devcontainers/features/node:1": {
      "version": "22",
      "nodeGypDependencies": true
    },
    "ghcr.io/devcontainers-contrib/features/fnm:1": {}
  },

  "customizations": {
    "vscode": {
      "extensions": [
        "ms-mssql.mssql",
        "ms-azuretools.vscode-docker",
        "dbaeumer.vscode-eslint",
        "esbenp.prettier-vscode",
        "bradlc.vscode-tailwindcss",
        "prisma.prisma",
        "mtxr.sqltools",
        "mtxr.sqltools-driver-pg",
        "mtxr.sqltools-driver-mssql",
        "humao.rest-client",
        "redhat.vscode-yaml",
        "streetsidesoftware.code-spell-checker",
        "github.copilot",
        "github.copilot-chat",
        "eamodio.gitlens"
      ],
      "settings": {
        "editor.defaultFormatter": "esbenp.prettier-vscode",
        "editor.formatOnSave": true,
        "editor.codeActionsOnSave": {
          "source.fixAll.eslint": "explicit"
        },
        "typescript.preferences.importModuleSpecifier": "relative",
        "mssql.connections": [
          {
            "server": "mssql",
            "database": "master",
            "authenticationType": "SqlLogin",
            "user": "sa",
            "password": "YourStrong@Passw0rd",
            "savePassword": true,
            "profileName": "Local SQL Server"
          }
        ],
        "sqltools.connections": [
          {
            "name": "PostgreSQL Local",
            "driver": "PostgreSQL",
            "server": "postgres",
            "port": 5432,
            "database": "devdb",
            "username": "devuser",
            "password": "devpassword"
          },
          {
            "name": "SQL Server Local",
            "driver": "MSSQL",
            "server": "mssql",
            "port": 1433,
            "database": "master",
            "username": "sa",
            "password": "YourStrong@Passw0rd"
          }
        ]
      }
    }
  },

  "forwardPorts": [3000, 3001, 5432, 1433],
  "portsAttributes": {
    "3000": { "label": "Next.js App", "onAutoForward": "notify" },
    "3001": { "label": "API Server", "onAutoForward": "notify" },
    "5432": { "label": "PostgreSQL", "onAutoForward": "silent" },
    "1433": { "label": "SQL Server", "onAutoForward": "silent" }
  },

  "postCreateCommand": "bash .devcontainer/post-create.sh",
  "postStartCommand": "bash .devcontainer/post-start.sh",

  "remoteUser": "node",

  "containerEnv": {
    "DATABASE_URL": "postgresql://devuser:devpassword@postgres:5432/devdb",
    "MSSQL_CONNECTION_STRING": "Server=mssql;Database=master;User Id=sa;Password=YourStrong@Passw0rd;TrustServerCertificate=true",
    "NODE_ENV": "development"
  }
}
